#include <p16f877A.inc>
    
    G1	    EQU 0X20
    VERI    EQU 0X21
    TMP	    EQU 0X22
    
    SAYI_L EQU 0X23
    SAYI_H EQU 0X24
    
    BASAMAK_1 EQU 0X25
    BASAMAK_2 EQU 0X26
    BASAMAK_3 EQU 0X27
    BASAMAK_4 EQU 0X28
 
    G2 EQU 0X29
	    
    ORG 0X00
    GOTO BASLA
    
    LCD_AYAR
	BANKSEL TRISB
	CLRF TRISB
	BANKSEL PORTB
	CLRF PORTB
	
	BCF PORTB,4
	
	MOVLW 0X02
	CALL GONDER
	
	MOVLW 0X28
	CALL GONDER
	
	MOVLW 0X01
	CALL GONDER
	
	MOVLW 0X10
	CALL GONDER
	
	MOVLW 0X06
	CALL GONDER
	
	MOVLW 0X0D
	CALL GONDER
	
	RETURN
	
    TETIKLEME
	BANKSEL PORTB
	BSF PORTB,5
	CALL GECIKME_200USN
	BCF PORTB,5
	RETURN
	
    GECIKME_200USN
	MOVLW 0XC8
	MOVWF G1
	AR:
	   DECFSZ G1,1
	   GOTO AR
	RETURN
	
    GECIKME_50MSN
	MOVLW 0X0F
	MOVWF G1
	
	MOVLW 0X28
	MOVWF G2
	
	DR: 
	    DECFSZ G1,1
	    GOTO DR
	    
	    DECFSZ G2,1
	    GOTO DR
	    
	RETURN
	
    GONDER
	MOVWF VERI
	SWAPF VERI,0
	ANDLW 0X0F
	MOVWF TMP
	MOVFW PORTB
	ANDLW 0XF0
	IORWF TMP,0
	MOVWF PORTB
	CALL TETIKLEME
	
	MOVFW VERI
	ANDLW 0X0F
	MOVWF TMP
	MOVFW PORTB
	ANDLW 0XF0
	IORWF TMP,0
	MOVWF PORTB
	CALL TETIKLEME
	
	RETURN
    
    CEVIR
	MOVF SAYI_H,F
	BTFSC STATUS,Z
	GOTO ATLA
	CALL CEVIR_2
	RETURN
	ATLA
	    CALL CEVIR_1
	RETURN
	
    CEVIR_2
	MOVFW SAYI_L
	MOVWF TMP
	T2
	    INCF BASAMAK_1,1
	    MOVLW .255
	    MOVWF SAYI_L
	    CALL CEVIR_1
	    DECFSZ SAYI_H,1
	    GOTO T2
	MOVFW TMP
	MOVWF SAYI_L
	CALL CEVIR_1
	RETURN
	
    CEVIR_1
	MOVF SAYI_L,F
	BTFSC STATUS,Z
	RETURN
	
	DECF SAYI_L,1
	INCF BASAMAK_1,1
	MOVLW .10
	SUBWF BASAMAK_1,0
	BTFSS STATUS,Z
	GOTO CEVIR_1
	
	CLRF BASAMAK_1
	INCF BASAMAK_2,1
	MOVLW .10
	SUBWF BASAMAK_2,W
	BTFSS STATUS,Z
	GOTO CEVIR_1
	
	CLRF BASAMAK_2
	INCF BASAMAK_3,1
	MOVLW .10
	SUBWF BASAMAK_3,0
	BTFSS STATUS,Z
	GOTO CEVIR_1
	
	CLRF BASAMAK_3
	INCF BASAMAK_4,1
	MOVLW .10
	SUBWF BASAMAK_4,0
	BTFSS STATUS,Z
	GOTO CEVIR_1
	
	RETURN

    ASCII_LOOKUP
	ADDWF PCL,1
	RETLW 0X30
	RETLW 0X31
	RETLW 0X32
	RETLW 0X33
	RETLW 0X34
	RETLW 0X35
	RETLW 0X36
	RETLW 0X37
	RETLW 0X38
	RETLW 0X39
	
    ADC_AYAR
	BANKSEL TRISA
	MOVLW 0XFF
	MOVWF TRISA
	
	BANKSEL ADCON0
	MOVLW 0X89
	MOVWF ADCON0
	
	BANKSEL ADCON1
	MOVLW 0X80
	MOVWF ADCON0
	
	BANKSEL PORTB
	
	CALL GECIKME_50MSN
	
	RETURN
	
    ADC_OKU
	BANKSEL ADCON0
	BSF ADCON0,GO
	FD:
	    BTFSC ADCON0,GO
	    GOTO FD
	
	BANKSEL ADRESH
	MOVFW ADRESH
	MOVWF SAYI_H
	
	BANKSEL ADRESL
	MOVFW ADRESL
	MOVWF SAYI_L
	
	BANKSEL PORTB
	
	RETURN
	
    TEMIZLE
	BANKSEL PORTB
	CLRF BASAMAK_1
	CLRF BASAMAK_2
	CLRF BASAMAK_3
	CLRF BASAMAK_4
	RETURN
	
    BASLA
	CALL LCD_AYAR
	CALL ADC_AYAR
	
	GG:
	CALL GECIKME_50MSN
	CALL GECIKME_50MSN
	CALL LCD_AYAR
	CALL TEMIZLE
	CALL ADC_OKU
	BSF PORTB,4
	
	CALL CEVIR
	
	MOVFW BASAMAK_4
	CALL ASCII_LOOKUP
	CALL GONDER
	
	MOVFW BASAMAK_3
	CALL ASCII_LOOKUP
	CALL GONDER
	
	MOVFW BASAMAK_2
	CALL ASCII_LOOKUP
	CALL GONDER
	
	MOVFW BASAMAK_1
	CALL ASCII_LOOKUP
	CALL GONDER
	 
	GOTO GG
	    
	RETURN
    
    END


